# è¿­ä»£å™¨ Iterator å’Œç”Ÿæˆå™¨ Generator

- **å¾ªçŽ¯**ï¼šè¯­è¨€å±‚é¢ä¸Šçš„è¯­æ³• => é‡å¤æ‰§è¡Œä¸€æ®µç¨‹åºçš„æ–¹æ¡ˆ
- **éåŽ†**ï¼šä¸šåŠ¡å±‚é¢ä¸Šçš„åšæ³• => è§‚å¯Ÿæˆ–èŽ·å–é›†åˆä¸­çš„å…ƒç´ çš„åšæ³•
- **è¿­ä»£**ï¼šå®žçŽ°å±‚é¢ä¸Šçš„æ¦‚å¿µ => å®žçŽ°éåŽ†çš„åº•å±‚æ–¹æ¡ˆå°±æ˜¯è¿­ä»£

## ðŸ“– è¿­ä»£å™¨ Iterator

### 1ã€æ¦‚å¿µ

> JavaScript åŽŸæœ‰çš„è¡¨ç¤ºâ€œé›†åˆâ€çš„æ•°æ®ç»“æž„ï¼Œä¸»è¦æ˜¯æ•°ç»„ `Array` å’Œå¯¹è±¡ `Object`ï¼ŒES6 åˆæ·»åŠ äº† `Map` å’Œ `Set`ã€‚è¿™æ ·å°±æœ‰äº†å››ç§æ•°æ®é›†åˆï¼Œç”¨æˆ·è¿˜å¯ä»¥ç»„åˆä½¿ç”¨å®ƒä»¬ï¼Œå®šä¹‰è‡ªå·±çš„æ•°æ®ç»“æž„ï¼Œæ¯”å¦‚æ•°ç»„çš„æˆå‘˜æ˜¯ `Map`ï¼Œ`Map` çš„æˆå‘˜æ˜¯å¯¹è±¡ã€‚è¿™æ ·å°±éœ€è¦ä¸€ç§ç»Ÿä¸€çš„æŽ¥å£æœºåˆ¶ï¼Œæ¥å¤„ç†æ‰€æœ‰ä¸åŒçš„æ•°æ®ç»“æž„ã€‚
>
> éåŽ†å™¨ Iterator å°±æ˜¯è¿™æ ·ä¸€ç§æœºåˆ¶ã€‚å®ƒæ˜¯ä¸€ç§æŽ¥å£ï¼Œ**ä¸ºå„ç§ä¸åŒçš„æ•°æ®ç»“æž„æä¾›ç»Ÿä¸€çš„è®¿é—®æœºåˆ¶**ã€‚ä»»ä½•æ•°æ®ç»“æž„åªè¦éƒ¨ç½² Iterator æŽ¥å£ï¼Œå°±å¯ä»¥å®ŒæˆéåŽ†æ“ä½œï¼ˆå³ä¾æ¬¡å¤„ç†è¯¥æ•°æ®ç»“æž„çš„æ‰€æœ‰æˆå‘˜ï¼‰ã€‚
>
> Iterator çš„ä½œç”¨æœ‰ä¸‰ä¸ªï¼š
>
> - ä¸€æ˜¯ä¸ºå„ç§æ•°æ®ç»“æž„ï¼Œæä¾›ä¸€ä¸ªç»Ÿä¸€çš„ã€ç®€ä¾¿çš„è®¿é—®æŽ¥å£ï¼›
> - äºŒæ˜¯ä½¿å¾—æ•°æ®ç»“æž„çš„æˆå‘˜èƒ½å¤ŸæŒ‰æŸç§æ¬¡åºæŽ’åˆ—ï¼›
> - ä¸‰æ˜¯ ES6 åˆ›é€ äº†ä¸€ç§æ–°çš„éåŽ†å‘½ä»¤ `for...of` å¾ªçŽ¯ï¼ŒIterator æŽ¥å£ä¸»è¦ä¾› `for...of` æ¶ˆè´¹ã€‚ï¼ˆå½“ä½¿ç”¨ `for...of` å¾ªçŽ¯éåŽ†æŸç§æ•°æ®ç»“æž„æ—¶ï¼Œè¯¥å¾ªçŽ¯ä¼šè‡ªåŠ¨åŽ»å¯»æ‰¾ Iterator æŽ¥å£ã€‚ï¼‰

### 2ã€é»˜è®¤çš„ Iterator æŽ¥å£

> ES6 è§„å®šï¼Œé»˜è®¤çš„ Iterator æŽ¥å£éƒ¨ç½²åœ¨æ•°æ®ç»“æž„çš„ `Symbol.iterator` å±žæ€§ï¼Œæˆ–è€…è¯´ï¼Œä¸€ä¸ªæ•°æ®ç»“æž„åªè¦å…·æœ‰ `Symbol.iterator` å±žæ€§ï¼Œå°±å¯ä»¥è®¤ä¸ºå®ƒæ˜¯â€œå¯éåŽ†çš„â€ï¼ˆiterableï¼‰ã€‚

ES6 çš„æœ‰äº›æ•°æ®ç»“æž„åŽŸç”Ÿå…·å¤‡ Iterator æŽ¥å£ï¼ˆæ¯”å¦‚æ•°ç»„ï¼‰ï¼Œå³ä¸ç”¨ä»»ä½•å¤„ç†ï¼Œå°±å¯ä»¥è¢« `for...of` å¾ªçŽ¯éåŽ†ã€‚åŽŸç”Ÿå…·å¤‡ Iterator æŽ¥å£çš„æ•°æ®ç»“æž„å¦‚ä¸‹ï¼ˆ`Object` å¹¶ä¸å…·å¤‡ï¼‰ï¼š

- `Array`
- `String`
- `Map`
- `Set`
- `TypedArray`
- `arguments`
- DOM `NodeList`

> æ³¨æ„ï¼š**å…·å¤‡ Iterator æŽ¥å£ => å¯ä»¥è¢« `for...of` å¾ªçŽ¯éåŽ†**

### 3ã€è¿­ä»£å™¨çš„éåŽ†è¿‡ç¨‹

1. åˆ›å»ºä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ï¼ŒæŒ‡å‘å½“å‰æ•°æ®ç»“æž„çš„èµ·å§‹ä½ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒéåŽ†å™¨å¯¹è±¡æœ¬è´¨ä¸Šï¼Œå°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ã€‚

2. ç¬¬ä¸€æ¬¡è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„ `next` æ–¹æ³•ï¼Œå¯ä»¥å°†æŒ‡é’ˆæŒ‡å‘æ•°æ®ç»“æž„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ã€‚

3. ç¬¬äºŒæ¬¡è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„ `next` æ–¹æ³•ï¼ŒæŒ‡é’ˆå°±æŒ‡å‘æ•°æ®ç»“æž„çš„ç¬¬äºŒä¸ªæˆå‘˜ã€‚

4. ä¸æ–­è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„ `next` æ–¹æ³•ï¼Œç›´åˆ°å®ƒæŒ‡å‘æ•°æ®ç»“æž„çš„ç»“æŸä½ç½®ã€‚

### 4ã€ä¼šè°ƒç”¨ Iterator æŽ¥å£çš„åœºæ™¯ 

ä¸€äº›åœºåˆä¼šé»˜è®¤è°ƒç”¨ Iterator æŽ¥å£ï¼ˆå³ `Symbol.iterator` æ–¹æ³•ï¼‰

- `for...of`
- è§£æž„èµ‹å€¼
- æ‰©å±•è¿ç®—ç¬¦ `...`
- `yield*`
- å…¶ä»–ï¼šç”±äºŽæ•°ç»„çš„éåŽ†ä¼šè°ƒç”¨éåŽ†å™¨æŽ¥å£ï¼Œæ‰€ä»¥ä»»ä½•**æŽ¥å—æ•°ç»„ä½œä¸ºå‚æ•°**çš„åœºåˆï¼Œå…¶å®ž**éƒ½è°ƒç”¨äº†éåŽ†å™¨æŽ¥å£**ã€‚
  - `Array.from()`
  - `Map()`ã€`Set()`ã€`WeakMap()`ã€`WeakSet()`ï¼ˆæ¯”å¦‚ `new Map([['a',1],['b',2]])`ï¼‰
  - `Promise.all()`
  - `Promise.race()`

## ðŸ“– ç”Ÿæˆå™¨ Generator

### 1ã€æ¦‚å¿µ

> Generator å‡½æ•°æœ‰å¤šç§ç†è§£è§’åº¦ã€‚è¯­æ³•ä¸Šï¼Œé¦–å…ˆå¯ä»¥æŠŠå®ƒç†è§£æˆï¼ŒGenerator å‡½æ•°æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œå°è£…äº†å¤šä¸ªå†…éƒ¨çŠ¶æ€ã€‚
>
> æ‰§è¡Œ Generator å‡½æ•°ä¼š**è¿”å›žä¸€ä¸ªéåŽ†å™¨å¯¹è±¡**ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒGenerator å‡½æ•°é™¤äº†çŠ¶æ€æœºï¼Œè¿˜æ˜¯ä¸€ä¸ªéåŽ†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ã€‚è¿”å›žçš„éåŽ†å™¨å¯¹è±¡ï¼Œå¯ä»¥ä¾æ¬¡éåŽ† Generator å‡½æ•°å†…éƒ¨çš„æ¯ä¸€ä¸ªçŠ¶æ€ã€‚

### 2ã€è¯­æ³•

å½¢å¼ä¸Š:

- `function` å…³é”®å­—ä¸Žå‡½æ•°åä¹‹é—´æœ‰ä¸€ä¸ª `*`ï¼›
- å‡½æ•°ä½“å†…éƒ¨ä½¿ç”¨ `yield` è¡¨è¾¾å¼ï¼Œå®šä¹‰ä¸åŒçš„å†…éƒ¨çŠ¶æ€*ï¼ˆyield[jild] äº§å‡ºï¼‰*ã€‚

å¹¶ä¸”å¯¹äºŽ `*` å·çš„ä½ç½®å¹¶æ²¡æœ‰è¦æ±‚

```javascript
function * generator (x, y) { Â·Â·Â· }
function *generator (x, y) { Â·Â·Â· }
function* generator (x, y) { Â·Â·Â· }
function*generator (x, y) { Â·Â·Â· }
```

### 3ã€åŸºæœ¬ä½¿ç”¨

```javascript
function * generator () {
	yield 1;
  yield 2;
  return 3;
}
const ge = generator();
```

ðŸ‘‰ è°ƒç”¨ Generator å‡½æ•°åŽï¼Œè¯¥å‡½æ•°**å¹¶ä¸æ‰§è¡Œ**ï¼Œè¿”å›žçš„ä¹Ÿä¸æ˜¯å‡½æ•°è¿è¡Œç»“æžœï¼Œè€Œæ˜¯**ä¸€ä¸ªæŒ‡å‘å†…éƒ¨çŠ¶æ€çš„æŒ‡é’ˆ**å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª**è¿­ä»£å™¨**ã€‚

ä¸‹ä¸€æ­¥ï¼Œå¿…é¡»è°ƒç”¨éåŽ†å™¨å¯¹è±¡çš„ `next()` æ–¹æ³•ï¼Œä½¿å¾—æŒ‡é’ˆç§»å‘ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚

è€Œæ¯æ¬¡è°ƒç”¨ `next()` æ–¹æ³•æ—¶ï¼Œå†…éƒ¨æŒ‡é’ˆå°±ä»Ž**å‡½æ•°å¤´éƒ¨**æˆ–**ä¸Šä¸€æ¬¡åœä¸‹æ¥çš„åœ°æ–¹**å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ª `yield` è¡¨è¾¾å¼ï¼ˆæˆ– `return` è¯­å¥ï¼‰ä¸ºæ­¢ã€‚

```javascript
ge.next(); // { value: 1, done: false }
ge.next(); // { value: 2, done: false }
ge.next(); // { value: 3, done: false }
ge.next(); // { value: undefined, done: true }
```

ðŸ‘‰ **Generator å‡½æ•°æ˜¯åˆ†æ®µæ‰§è¡Œçš„ï¼Œ`yield` è¡¨è¾¾å¼æ˜¯æš‚åœæ‰§è¡Œçš„æ ‡è®°ï¼Œè€Œ `next()` æ–¹æ³•å¯ä»¥æ¢å¤æ‰§è¡Œã€‚**

## ðŸ“‘ å¼•ç”¨

> ç¬”è®°æ¥è‡ªï¼š
>
> - [ðŸ‘‰ https://es6.ruanyifeng.com/#README](https://es6.ruanyifeng.com/#README)
> - [ðŸ‘‰ https://www.bilibili.com/video/BV1jU4y157Jx?p=11](https://www.bilibili.com/video/BV1jU4y157Jx?p=11)

